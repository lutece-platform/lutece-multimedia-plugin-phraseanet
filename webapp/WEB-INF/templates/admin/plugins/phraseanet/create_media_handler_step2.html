<#assign dtBoxId="" />
<div class="row">
	<div class="col-xs-12 col-sm-12">
		<div class="box box-primary">
			<div class="box-header">
				<h3 class="box-title">#i18n{phraseanet.create_media_handler.title}</h3>
			</div>
			<div class="box-body">
				<form class="form-horizontal" method="post" enctype="multipart/form-data" name="create_media_handler" id="create_media_handler" action="jsp/admin/plugins/phraseanet/DoCreateMediaHandler.jsp">
					<input type="hidden" name="media_type" value="${media_type}">
					<input type="hidden" name="id_account" value="${account.id}">
					<input type="hidden" name="description" value="${description}">
					<input type="hidden" name="name" value="${media_handler_name}">
					<div class="form-group">
						<label class="control-label col-xs-12 col-sm-3" for="name">#i18n{phraseanet.create_media_handler.labelName} * :</label>
						<div class="col-xs-12 col-sm-9">
							<input disabled="disabled" type="text" id="name" name="name" class="form-control" maxlength="50" tabindex="1" value="${media_handler_name}">
						</div>
					</div>
					<div class="form-group">
						<label class="control-label col-xs-12 col-sm-3" for="name">#i18n{phraseanet.create_media_handler.labelMetaDatasList} * </label>
						<div class="col-xs-12 col-sm-9">
							<#if databoxes_list?? && databoxes_list?has_content>
								<ul>
									<#list databoxes_list as databoxe>
										<li>
											<a class="btn btn-default"  data-toggle="modal" data-target="#metaDataModal" href="jsp/admin/plugins/phraseanet/DisplayMetadatas.jsp?id_databoxe=${databoxe.databoxId}&id_account=${account.id}" onclick="window.open('jsp/admin/plugins/phraseanet/DisplayMetadatas.jsp?id_databoxe=${databoxe.databoxId}&id_account=${account.id}','','resizable=yes, location=no, width=500, height=300, menubar=no, status=no, scrollbars=yes, menubar=no');">
												${databoxe.name}&nbsp;<i class="icon-info-sign"></i>
											</a>
										</li>
									</#list>
								</ul>
								<#else>
									<div class="alert alert-error">#i18n{portal.util.labelNoItem}</div>
							</#if>
						</div>
					</div>
					<div class="form-group">
						<label class="control-label col-xs-12 col-sm-3" for="insert_template">#i18n{phraseanet.create_media_handler.labelInsertTemplate} *</label>
						<div class="col-xs-12 col-sm-9">
							<textarea rows="15" id="insert_template" name="insert_template" class="form-control" tabindex="3">
								<#if default_template??>${default_template}</#if>
							</textarea>
						</div>
					</div>
					<div class="form-group">
						<label class="control-label col-xs-12 col-sm-3" for="bases">#i18n{phraseanet.create_media_handler.labelCollectionsList} </label>
						<div class="col-xs-12 col-sm-9">
							<#if databoxes_list?? && databoxes_list?has_content>
								<ul>
									<#list databoxes_list as databoxe>
										<li>
											<a class="btn btn-default"  data-toggle="modal" data-target="#collectionListModal" href="jsp/admin/plugins/phraseanet/DisplayCollections.jsp?id_databoxe=${databoxe.databoxId}&id_account=${account.id}" onClick="window.open('jsp/admin/plugins/phraseanet/DisplayCollections.jsp?id_databoxe=${databoxe.databoxId}&id_account=${account.id}','','resizable=yes, location=no, width=500, height=300, menubar=no, status=no, scrollbars=yes, menubar=no');">
												${databoxe.name} <i class="fa fa-info-circle"></i>
											</a>
										</li>
										<#assign dtBoxId=databoxe.databoxId />
									</#list>
								</ul>
							</#if>
						</div>
					</div>
					<div class="form-group">
						<div class="col-xs-12 col-sm-offset-3 col-sm-9">
							<button class="btn btn-primary btn-flat" type="submit">
								<i class="fa fa-check"></i> #i18n{phraseanet.create_media_handler.buttonValidate}
							</button>
							<a class="btn btn-default btn-flat" href="jsp/admin/plugins/phraseanet/CreateMediaHandlerStep1.jsp?name=${media_handler_name}&description=${description}&id_account=${account.id}&media_type=${media_type}" title="#i18n{portal.admin.message.buttonCancel}">
								<i class="fa fa-remove"></i> #i18n{portal.admin.message.buttonCancel}
							</a>
						</div>
					</div>
				</form>
			</div>
		</div>
	</div>
</div>

<div class="modal fade" id="collectionListModal" tabindex="-1" role="dialog" aria-labelledby="collectionListModalLabel">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        <h4 class="modal-title" id="collectionListModalLabel">#i18n{phraseanet.create_media_handler.labelCollectionsList}</h4>
      </div>
      <div class="modal-body"></div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>

<div class="modal fade" id="metaDataModal" tabindex="-1" role="dialog" aria-labelledby="metaDataModalLabel">
 	<div class="modal-dialog">
     <div class="modal-content">
       <div class="modal-header">
         <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
         <h4 class="modal-title" id="metaDataModalLabel">#i18n{phraseanet.create_media_handler.labelMetaDatasList}</h4>
       </div>
       <div class="modal-body">
       </div>
       <div class="modal-footer">
         <button type="button" class="btn btn-default" data-dismiss="modal">#i18n{portal.util.labelCancel}</button>
       </div>
     </div>
   </div>
 </div>
